<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>R course</title>
    <meta charset="utf-8" />
    <meta name="author" content="" />
    <script src="libs/header-attrs-2.20/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.27/datatables.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="Font_Style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# R course
]
.author[
### 
]

---

class: center, middle
&lt;span style="font-size: 60px;"&gt;第九章&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 50px;"&gt;如何进行基本的数据分析&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 50px;"&gt;中介和调节分析&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 30px;"&gt;PROCESS and lavaan(SEM)&lt;/span&gt; &lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;span style="font-size: 30px;"&gt;胡传鹏&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 30px;"&gt;2023/04/17&lt;/span&gt; &lt;br&gt;

---
class: center, middle
&lt;span style="font-size: 60px;"&gt;9.1 事前准备&lt;/span&gt; &lt;br&gt;
---
# &lt;h1 lang="zh-CN"&gt;必须要知道的东西&lt;/h1&gt;
&lt;br&gt;
&lt;center&gt;
&lt;h2 lang="en"&gt;中介调节的鼻祖：Baron &amp; Kenny (1986)&lt;/h2&gt;
&lt;/center&gt;
&lt;br&gt;

&lt;div style="display:flex; align-items:center;"&gt;
  &lt;img src="http://3.bp.blogspot.com/-6OBEhzon_Bk/VfHWHZXlSYI/AAAAAAAAd_Q/chk77Yk2Ohc/s1600/B%2526K%2Bmediator.png" style="width:50%; height: 50%;"&gt;
  &lt;img src="http://1.bp.blogspot.com/-LoVbz4fImR8/VfHWKAH073I/AAAAAAAAd_Y/gPJHy1moJFk/s1600/B%2526K%2Bmoderator.png" style="width:50%;"&gt;
&lt;/div&gt;
&lt;br&gt;
_&lt;h5 lang="en"&gt;- Baron, R. M., &amp; Kenny, D. A. (1986). The moderator–mediator variable distinction in social psychological research: Conceptual, strategic, and statistical considerations. Journal of personality and social psychology, 51(6), 1173. &lt;/h5&gt;_
---
# &lt;h1 lang="zh-CN"&gt;必须要知道的东西&lt;/h1&gt;
&lt;br&gt;
&lt;center&gt;
&lt;h2 lang="en"&gt;PROCESS的作者：Andrew F. Hayes &lt;/h2&gt;
&lt;/center&gt;
&lt;br&gt;

&lt;div style="display:flex; align-items:center; justify-content:center;"&gt;
  &lt;img src="https://m.media-amazon.com/images/I/51h5ymu3dpL._SX348_BO1,204,203,200_.jpg" style="width:30%; height: 30%; margin-right: 20px;"&gt;
  &lt;img src="https://www.guilford.com/covers/large/9781462549030.jpg" style="width:30%; height: 30%;"&gt;
&lt;/div&gt;
&lt;br&gt;
_&lt;h5 lang="en"&gt;- Hayes, A. F. (2017). Introduction to mediation, moderation, and conditional process analysis: A regression-based approach. Guilford publications. &lt;/h5&gt;_
---
# &lt;h1 lang="zh-CN"&gt;必须要知道的东西&lt;/h1&gt;
&lt;br&gt;
&lt;center&gt;
&lt;h2 lang="en"&gt;解释调节很重要的一本书：Aiken, West &amp; Reno (1991) &lt;/h2&gt;
&lt;/center&gt;
&lt;br&gt;
&lt;div style="display:flex; align-items:center;"&gt;
  &lt;img src="https://m.media-amazon.com/images/I/61rbpLiQmjL._AC_UF1000,1000_QL80_.jpg" style="width:25%; height: 25%;margin-right: 40px;"&gt;

  - 因为对调节效应中对交乘项系数的解释，有很多误解。&lt;br&gt; 

  - 不论是Hayes 还是 Aiken &amp; West 都在这方面有类似的解释 (Hayes, 2017, p. 282; Aiken &amp; West, 1991, p. 36).
  &lt;br&gt;
  &lt;br&gt;
  _对调节效应的理解，也有助于日后学习HLM_
&lt;/div&gt;
&lt;br&gt;
_&lt;h5 lang="en"&gt;- Aiken, L. S., West, S. G., &amp; Reno, R. R. (1991). Multiple regression: Testing and interpreting interactions. sage. &lt;/h5&gt;_
---
# &lt;h1 lang="zh-CN"&gt;必须要知道的东西&lt;/h1&gt;
&lt;br&gt;
&lt;center&gt;
&lt;h2 lang="en"&gt;bruceR::PROCESS &amp; lavaan &lt;/h2&gt;
&lt;/center&gt;
&lt;br&gt;

&lt;div style="display:flex; align-items:center; justify-content:center;"&gt;
  &lt;img src="https://raw.githubusercontent.com/psychbruce/bruceR/main/man/figures/logo.png" style="width:30%; height: 30%; margin-right: 40px;"&gt;
  &lt;img src="https://assets.datacamp.com/production/course_6419/shields/original/shield_image_course_6419_20180703-12-1hbh8vg?1530639951" style="width:30%; height: 30%;"&gt;
&lt;/div&gt;
&lt;br&gt;
_&lt;h5 lang="en"&gt;- Bao, H.-W.-S. (2022). bruceR: Broadly useful convenient and efficient R functions. R package version 0.8.x. https://CRAN.R-project.org/package=bruceR &lt;/h5&gt;_
_&lt;h5 lang="en"&gt;- Rosseel Y (2012). “lavaan: An R Package for Structural Equation Modeling.” Journal of Statistical Software, 48(2), 1–36. doi:10.18637/jss.v048.i02. &lt;/h5&gt;_
---
# &lt;h1 lang="zh-CN"&gt;载入包 - 设置工作路径 - 导入原始数据&lt;/h1&gt;

```r
library(here)
library(lavaan)
library(lavaanPlot)
#library(bruceR)
library(dplyr)
library(tidyr)

# 载入bruceR有点慢，PPT中就不载入了
```

---
# &lt;h1 lang="zh-CN"&gt;载入包 - 设置工作路径 - 导入原始数据&lt;/h1&gt;

```r
WD &lt;-  here::here()

df.pg.raw &lt;-  read.csv('../DATA/penguin_rawdata.csv',
                       header = T, sep=",", stringsAsFactors = FALSE)
```
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-390b6ed0e10292db42a8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-390b6ed0e10292db42a8">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6","7","8","9","10"],[1975,1995,1995,1988,1991,1995,1996,1973,1996,1996],[1,2,4,2,2,2,1,3,2,3],[1,2,1,3,1,3,1,3,3,3],[1,2,1,4,1,1,1,2,1,1],[2,2,2,5,5,3,1,3,3,2],[2,2,4,3,2,2,4,4,2,4],[1,2,1,4,2,1,1,4,2,1],[2,2,4,2,3,1,2,4,2,2],[2,2,1,4,4,2,1,4,2,4],[4,4,1,4,1,1,4,4,2,4],[1,2,2,3,1,2,2,5,2,1],[1,2,1,2,2,1,1,3,1,4],[2,2,1,2,1,2,2,2,2,1],[4,2,2,4,2,3,4,2,2,2],[3,2,1,2,4,4,3,3,4,3],[4,3,1,4,4,5,5,4,3,5],[2,2,1,3,2,4,5,1,2,4],[3.72222222222222,4.05555555555556,1.44444444444444,4.72222222222222,2.11111111111111,2,2.55555555555556,3.05555555555556,3.55555555555556,4.38888888888889],[6,0,0,2,0,0,null,0,0,0],[3.11111111111111,4.88888888888889,1.33333333333333,3.88888888888889,4.66666666666667,3.33333333333333,3.11111111111111,3.55555555555556,3.33333333333333,3.22222222222222],[3.44444444444444,2,2,3,1.77777777777778,2.44444444444444,3.77777777777778,3.33333333333333,1.88888888888889,4.22222222222222],[89,89,89,89,89,89,89,89,89,89],[3.27777777777778,3,1.61111111111111,3.94444444444444,4.94444444444444,3.77777777777778,6.44444444444444,3.22222222222222,4,5.27777777777778],[15,null,null,null,null,null,null,10,null,1],[1.63636363636364,2.18181818181818,2,3.27272727272727,2.18181818181818,1.72727272727273,1.72727272727273,3.54545454545455,2,2.63636363636364],[1,1,1,2,1,1,1,1,1,1],[5,6,1,3,1,1,2,3,4,5],[5,4,1,6,1,1,1,2,4,6],[3,2,1,6,1,1,4,3,4,6],[5,5,1,5,1,2,1,2,4,5],[5,5,1,4,1,2,4,3,4,4],[3,2,1,4,5,1,1,3,1,3],[1,3,1,3,2,1,2,3,4,5],[6,5,1,3,1,2,7,3,4,7],[5,2,1,4,7,6,1,3,4,3],[2,3,1,4,1,2,4,1,4,3],[6,7,1,6,6,2,2,5,2,6],[3,4,1,5,1,2,1,2,4,4],[3,3,1,6,2,4,2,5,4,4],[2,3,7,5,1,1,1,4,1,2],[3,4,1,5,2,2,1,5,4,1],[3,5,3,5,1,1,2,3,4,4],[6,5,1,6,2,3,6,3,4,7],[1,5,1,5,2,2,4,2,4,4],[2,3,2,5,1,5,7,3,4,5],[2,4,2,5,7,5,1,2,4,7],[5,3,2,5,2,4,6,4,4,5],[3,2,2,4,5,4,7,3,4,5],[3,2,2,3,2,3,7,3,4,6],[2,3,1,4,4,4,7,3,4,5],[5,3,1,6,2,3,7,4,4,6],[5,4,1,3,6,3,7,4,4,7],[3,5,1,3,7,1,7,4,4,7],[2,3,1,4,6,3,6,3,4,4],[4,2,2,5,6,6,6,3,4,4],[2,2,2,3,6,5,7,2,4,5],[3,4,1,4,7,4,7,2,4,3],[3,2,2,5,2,3,7,3,4,6],[4,3,3,3,7,4,6,3,4,5],[5,3,1,2,6,5,7,4,4,6],[4,3,1,3,6,3,7,6,4,5],[2,3,2,4,7,3,7,2,4,4],["9:23:38","9:23:26","8:57:08","8:55:14","8:54:35","8:39:12","8:32:08","8:28:57","8:28:03","8:25:57"],[3,2.2,1.2,3,2.6,3.6,3.8,2.4,2.6,3],[2,2,2,2,2,2,2,2,2,2],[0,0,12,0,5,0,null,1,0,2],[4,4,4,3,4,4,4,1,3,3],[4,5,1,5,5,4,5,3,3,4],[3,5,1,4,5,4,2,3,3,5],[4,5,4,5,5,4,4,2,4,3],[3,5,1,5,5,4,5,4,5,3],[3,5,1,4,4,4,2,3,4,4],[2,4,1,2,5,2,1,4,3,2],[4,5,1,2,4,2,5,5,2,2],[3,5,1,4,4,3,1,4,3,3],[2,5,1,4,5,3,3,4,3,3],[4,1,5,5,1,3,2,3,3,4],[4,2,6,4,1,3,2,3,3,5],[5,6,5,3,3,3,2,2,2,1],[4,2,4,1,2,2,2,2,1,3],[4,3,3,2,2,2,2,2,3,2],[1,2,1,2,2,4,2,3,3,3],[2,2,1,2,1,4,2,3,1,2],[17,28,24,19,29,33,53,17,17,19],[4.33333333333333,6.5,6.83333333333333,3.5,1.5,2,5.83333333333333,6.33333333333333,5.66666666666667,5.16666666666667],[2.27272727272727,2.63636363636364,2.18181818181818,2,1.90909090909091,2.45454545454545,2.81818181818182,2.54545454545455,1.81818181818182,3.90909090909091],[2,3,3,1,3,4,4,2,2,5],[2,2,4,1,2,4,4,3,3,4],[2,3,2,2,1,2,2,3,2,5],[4,3,4,3,4,4,2,2,2,4],[2,3,1,2,1,3,3,3,2,3],[2,2,1,2,1,1,2,2,1,3],[2,2,1,2,1,2,2,4,2,4],[2,3,3,1,1,1,2,3,2,3],[3,3,3,2,2,2,4,2,1,3],[2,3,1,4,2,1,2,1,1,4],[2,2,1,2,3,3,4,3,2,5],[4,2,1,2,2,3,3,3,3,4],[4,2,4,4,1,3,4,4,2,4],[2,2,1,3,1,2,5,3,1,2],[5,2,4,2,1,3,4,3,4,4],[2,2,1,3,1,2,1,2,3,5],[2,2,1,2,3,2,3,4,1,4],[4,2,1,3,2,2,5,3,1,5],[4,2,1,4,1,3,5,4,1,5],[4,2,4,4,4,2,4,4,1,5],[2,2,1,1,2,2,2,2,2,2],[2,4,2,4,3,5,2,1,3,3],[2,4,3,2,5,5,4,4,3,4],[2,4,3,1,5,5,2,5,5,5],[1,4,2,1,3,2,2,2,5,1],[1,4,4,2,5,3,1,2,5,2],[4,3,2,1,5,4,3,3,3,1],[2,4,4,2,5,3,2,3,4,2],[2,2,1,3,4,3,2,2,5,4],[5,4,3,4,4,5,4,4,3,3],[4,3,5,3,3,5,5,3,4,2],[3,4,4,2,4,5,3,2,2,5],[5,5,4,2,4,4,1,3,4,3],[4,4,4,2,4,3,2,2,2,2],[2.84615384615385,3.76923076923077,3.15384615384615,2.23076923076923,4.15384615384615,4,2.53846153846154,2.76923076923077,3.69230769230769,2.84615384615385],[1,1,1,2,1,1,2,1,1,2],[1,2,2,2,2,2,2,1,2,1],[2,1,1,1,2,2,2,4,2,2],[1,1,1,1,1,1,1,1,1,1],[null,null,null,null,null,null,null,null,null,null],[4,4,4,4,2,4,4,4,4,4],[4,4,4,4,2,4,4,2,4,4],[5,1,4,5,5,5,5,5,5,5],[null,null,4,null,null,null,null,null,null,null],[1,8,2,1,8,2,3,8,2,6],[null,6,2,null,5,1,2,3,2,3],[6,4,5,5,7,5,8,4,3,8],[3,1,5,1,3,5,8,4,2,8],[1,1,1,1,2,1,1,1,1,1],[null,null,null,null,8,null,null,null,null,null],[1,2,2,1,1,2,2,2,2,2],[null,8,8,null,null,8,8,8,8,8],[3,3,2,3,3,1,1,1,1,1],[2,8,1,8,1,null,null,null,null,null],[6,5,6,4,8,null,null,null,null,null],[1,3,1,1,1,8,6,4,1,3],[1,1,1,1,1,1,1,2,1,1],[null,null,null,null,null,null,null,2,null,null],[1,1,1,2,1,2,2,2,2,1],[" "," "," "," "," ","Rowing Club","University Friends","ODAA","Oxford Latin Speaking Society"," "],[" "," "," "," "," ","Rugby Club","Business Social"," ","Oxford Latin Conversation Society"," "],[" "," "," "," "," "," ","Lecturers/ Advisors"," ","Plato Reading Group"," "],[" "," "," "," "," "," ","Friends from home"," "," "," "],[" "," "," "," "," "," ","Neighbors"," "," "," "],[null,null,null,null,null,7,20,1,2,null],[null,null,null,null,null,7,15,null,4,null],[null,null,null,null,null,null,5,null,1,null],[null,null,null,null,null,null,9,null,null,null],[null,null,null,null,null,null,6,null,null,null],[6,6,7,2,1,1,6,6,7,7],[5,7,7,5,2,2,7,6,7,4],[5,6,7,3,2,3,5,7,6,5],[3,7,7,4,1,2,5,6,6,5],[2,6,7,5,2,2,6,7,5,5],[5,7,6,2,1,2,6,6,3,5],[4,6,6,4,1,2,5,6,3,4],[5,7,8,5,7,6,null,7,6,6],[1,2,3,1,2,4,null,2,2,3],[4,2,4,4,1,2,2,3,3,1],[4,4,5,2,1,4,4,2,5,4],[4,3,4,3,1,4,2,3,4,4],[5,3,4,3,4,4,4,4,2,4],[2,3,4,4,4,4,5,2,2,3],[2,4,4,3,1,3,4,3,1,3],[2,5,4,3,3,4,5,4,2,2],[2,2,4,3,4,3,5,3,2,4],[4,5,5,2,1,2,4,2,4,5],[2,3,2,2,1,4,1,4,4,5],[2,2,1,2,1,2,2,2,2,1],[1,2,2,2,4,4,4,2,2,2],[4,4,4,3,4,2,2,3,2,1],[5,4,2,3,2,4,3,4,4,4],[4,4,2,3,3,1,2,4,5,3],[2,3,4,4,4,5,5,4,4,4],[2,3,5,4,4,3,2,4,2,2],[4,3,4,2,4,3,4,3,3,2],[3,3,5,2,4,4,4,4,3,3],[2,3,1,3,5,4,1,3,2,4],[4,3,4,2,4,4,5,4,3,5],[3,3,5,4,4,3,2,2,3,3],[2,3,1,3,4,3,2,3,4,3],[3,3,1,4,1,2,2,2,3,3],[4,3,5,3,1,2,5,1,4,4],[3,3,3,2,1,3,3,2,3,3],[4,3,1,4,4,4,2,4,1,1],[4,5,4,2,1,3,1,4,4,5],[3,5,4,4,1,2,1,3,5,5],[3,2,2,4,4,2,5,2,2,4],[2,4,2,5,1,2,1,3,2,4],[4,3,1,2,4,2,5,1,1,4],[4,3,2,2,3,3,1,4,3,4],[1,4,3,4,4,2,1,3,2,2],[2,4,2,3,5,4,2,5,1,4],[2,4,2,4,5,4,4,4,2,4],[4,4,4,3,4,4,2,4,2,4],[3,4,2,4,4,4,4,5,5,1],[4,2,2,3,4,4,5,2,2,4],[5,3,3,2,4,2,2,2,2,4],[4,3,2,3,3,3,2,1,2,4],[4,3,5,2,4,4,4,4,4,4],[1,4,2,3,4,2,2,3,2,3],[1,2,2,4,4,2,1,2,1,2],[4,3,2,3,1,2,1,4,4,2],[4,4,4,2,1,4,1,4,3,3],[3,3,4,3,4,2,4,3,3,4],[1,2,5,4,4,2,1,2,1,2],[2,3,5,4,4,2,1,2,1,2],[4,3,5,4,4,4,3,3,3,4],[4,4,2,5,1,3,5,2,4,5],[2,4,5,3,1,2,5,4,2,4],[2,4,4,3,4,2,1,3,2,2],[4,3,4,3,5,2,4,4,2,4],[2,4,2,2,4,3,3,2,2,4],[2,4,1,2,4,2,2,2,2,2],[1,2,5,4,1,1,4,2,2,2],[3.07692307692308,2.46153846153846,2.38461538461538,2.84615384615385,2.53846153846154,2.07692307692308,1.53846153846154,3,2.61538461538462,3.15384615384615],[4,2,3,3,3,2,1,4,5,3],[2,3,3,3,4,2,2,3,2,4],[4,3,4,4,3,3,1,3,3,5],[4,3,1,2,2,2,2,3,2,4],[4,2,2,3,2,2,2,3,2,3],[3,2,1,2,1,2,2,3,2,1],[4,2,2,3,3,2,1,4,2,3],[3,2,2,2,2,2,1,4,3,4],[3,2,3,3,2,2,2,1,2,3],[2,3,3,3,3,2,1,3,4,3],[4,2,3,4,3,2,2,2,1,2],[3,4,4,3,5,4,4,4,5,4],[2,4,2,3,2,2,2,3,3,2],[1,2,2,2,3,2,1,3,3,4],[34.9,35.8,34,36.9,35.3,34.7,36,36.5,34.7,35.9],[35.9,36,36.2,37,36.1,36.4,36.3,36.6,36.3,36.3],[2,2,2,2,4,4,2,2,2,2],[35.4,35.9,35.1,36.95,35.7,35.55,36.15,36.55,35.5,36.1],[1,1,1,1,1,1,1,1,1,1],[-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667,-1.66666666666667],[5,5,5,5,5,5,5,5,5,5],[1,1,1,1,1,1,1,1,1,1],[0.186319647739787,0.472682850177291,-1.77049556891649,1.0454092550523,-1.19776916404149,-1.29322356485399,-0.815951560791479,-0.386406757135223,0.0431380465210342,0.759046052614796],[-0.00190690952064737,-0.249805147204807,-1.48929633562561,0.593048860921336,1.48548251658431,0.44430991831084,2.82413300007877,-0.0514865570574791,0.642628508458168,1.7829604018053],["Oxford","Oxford","Oxford","Oxford","Oxford","Oxford","Oxford","Oxford","Oxford","Oxford"]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>ALEX1<\/th>\n      <th>ALEX2<\/th>\n      <th>ALEX3<\/th>\n      <th>ALEX4<\/th>\n      <th>ALEX5<\/th>\n      <th>ALEX6<\/th>\n      <th>ALEX7<\/th>\n      <th>ALEX8<\/th>\n      <th>ALEX9<\/th>\n      <th>ALEX10<\/th>\n      <th>ALEX11<\/th>\n      <th>ALEX12<\/th>\n      <th>ALEX13<\/th>\n      <th>ALEX14<\/th>\n      <th>ALEX15<\/th>\n      <th>ALEX16<\/th>\n      <th>anxiety<\/th>\n      <th>artgluctot<\/th>\n      <th>attachhome<\/th>\n      <th>attachphone<\/th>\n      <th>AvgHumidity<\/th>\n      <th>avoidance<\/th>\n      <th>cigs<\/th>\n      <th>DIDF<\/th>\n      <th>eatdrink<\/th>\n      <th>ECR1<\/th>\n      <th>ECR2<\/th>\n      <th>ECR3<\/th>\n      <th>ECR4<\/th>\n      <th>ECR5<\/th>\n      <th>ECR6<\/th>\n      <th>ECR7<\/th>\n      <th>ECR8<\/th>\n      <th>ECR9<\/th>\n      <th>ECR10<\/th>\n      <th>ECR11<\/th>\n      <th>ECR12<\/th>\n      <th>ECR13<\/th>\n      <th>ECR14<\/th>\n      <th>ECR15<\/th>\n      <th>ECR16<\/th>\n      <th>ECR17<\/th>\n      <th>ECR18<\/th>\n      <th>ECR19<\/th>\n      <th>ECR20<\/th>\n      <th>ECR21<\/th>\n      <th>ECR22<\/th>\n      <th>ECR23<\/th>\n      <th>ECR24<\/th>\n      <th>ECR25<\/th>\n      <th>ECR26<\/th>\n      <th>ECR27<\/th>\n      <th>ECR28<\/th>\n      <th>ECR29<\/th>\n      <th>ECR30<\/th>\n      <th>ECR31<\/th>\n      <th>ECR32<\/th>\n      <th>ECR33<\/th>\n      <th>ECR34<\/th>\n      <th>ECR35<\/th>\n      <th>ECR36<\/th>\n      <th>endtime<\/th>\n      <th>EOT<\/th>\n      <th>exercise<\/th>\n      <th>gluctot<\/th>\n      <th>health<\/th>\n      <th>HOME1<\/th>\n      <th>HOME2<\/th>\n      <th>HOME3<\/th>\n      <th>HOME4<\/th>\n      <th>HOME5<\/th>\n      <th>HOME6<\/th>\n      <th>HOME7<\/th>\n      <th>HOME8<\/th>\n      <th>HOME9<\/th>\n      <th>KAMF1<\/th>\n      <th>KAMF2<\/th>\n      <th>KAMF3<\/th>\n      <th>KAMF4<\/th>\n      <th>KAMF5<\/th>\n      <th>KAMF6<\/th>\n      <th>KAMF7<\/th>\n      <th>networksize<\/th>\n      <th>nostalgia<\/th>\n      <th>onlineid<\/th>\n      <th>onlineid1<\/th>\n      <th>onlineid2<\/th>\n      <th>onlineid3<\/th>\n      <th>onlineid4<\/th>\n      <th>onlineid5<\/th>\n      <th>onlineid6<\/th>\n      <th>onlineid7<\/th>\n      <th>onlineid8<\/th>\n      <th>onlineid9<\/th>\n      <th>onlineid10<\/th>\n      <th>onlineide11<\/th>\n      <th>phone1<\/th>\n      <th>phone2<\/th>\n      <th>phone3<\/th>\n      <th>phone4<\/th>\n      <th>phone5<\/th>\n      <th>phone6<\/th>\n      <th>phone7<\/th>\n      <th>phone8<\/th>\n      <th>phone9<\/th>\n      <th>romantic<\/th>\n      <th>scontrol1<\/th>\n      <th>scontrol2<\/th>\n      <th>scontrol3<\/th>\n      <th>scontrol4<\/th>\n      <th>scontrol5<\/th>\n      <th>scontrol6<\/th>\n      <th>scontrol7<\/th>\n      <th>scontrol8<\/th>\n      <th>scontrol9<\/th>\n      <th>scontrol10<\/th>\n      <th>scontrol11<\/th>\n      <th>scontrol12<\/th>\n      <th>scontrol13<\/th>\n      <th>selfcontrol<\/th>\n      <th>sex<\/th>\n      <th>smoke<\/th>\n      <th>SNI1<\/th>\n      <th>SNI2<\/th>\n      <th>SNI3<\/th>\n      <th>SNI4<\/th>\n      <th>SNI5<\/th>\n      <th>SNI6<\/th>\n      <th>SNI7<\/th>\n      <th>SNI8<\/th>\n      <th>SNI9<\/th>\n      <th>SNI10<\/th>\n      <th>SNI11<\/th>\n      <th>SNI12<\/th>\n      <th>SNI13<\/th>\n      <th>SNI14<\/th>\n      <th>SNI15<\/th>\n      <th>SNI16<\/th>\n      <th>SNI17<\/th>\n      <th>SNI18<\/th>\n      <th>SNI19<\/th>\n      <th>SNI20<\/th>\n      <th>SNI21<\/th>\n      <th>SNI22<\/th>\n      <th>SNI23<\/th>\n      <th>SNI24<\/th>\n      <th>SNI25<\/th>\n      <th>SNI26<\/th>\n      <th>SNI27<\/th>\n      <th>SNI28<\/th>\n      <th>SNI29<\/th>\n      <th>SNI30<\/th>\n      <th>SNI31<\/th>\n      <th>SNI32<\/th>\n      <th>SNS1<\/th>\n      <th>SNS2<\/th>\n      <th>SNS3<\/th>\n      <th>SNS4<\/th>\n      <th>SNS5<\/th>\n      <th>SNS6<\/th>\n      <th>SNS7<\/th>\n      <th>socialdiversity<\/th>\n      <th>socialembedded<\/th>\n      <th>STRAQ_1<\/th>\n      <th>STRAQ_2<\/th>\n      <th>STRAQ_3<\/th>\n      <th>STRAQ_4<\/th>\n      <th>STRAQ_6<\/th>\n      <th>STRAQ_7<\/th>\n      <th>STRAQ_8<\/th>\n      <th>STRAQ_9<\/th>\n      <th>STRAQ_10<\/th>\n      <th>STRAQ_11<\/th>\n      <th>STRAQ_12<\/th>\n      <th>STRAQ_19<\/th>\n      <th>STRAQ_20<\/th>\n      <th>STRAQ_21<\/th>\n      <th>STRAQ_22<\/th>\n      <th>STRAQ_23<\/th>\n      <th>STRAQ_24<\/th>\n      <th>STRAQ_25<\/th>\n      <th>STRAQ_26<\/th>\n      <th>STRAQ_27<\/th>\n      <th>STRAQ_28<\/th>\n      <th>STRAQ_29<\/th>\n      <th>STRAQ_30<\/th>\n      <th>STRAQ_31<\/th>\n      <th>STRAQ_32<\/th>\n      <th>STRAQ_33<\/th>\n      <th>STRAQ_5<\/th>\n      <th>STRAQ_13<\/th>\n      <th>STRAQ_14<\/th>\n      <th>STRAQ_15<\/th>\n      <th>STRAQ_16<\/th>\n      <th>STRAQ_17<\/th>\n      <th>STRAQ_18<\/th>\n      <th>STRAQ_34<\/th>\n      <th>STRAQ_35<\/th>\n      <th>STRAQ_36<\/th>\n      <th>STRAQ_37<\/th>\n      <th>STRAQ_38<\/th>\n      <th>STRAQ_39<\/th>\n      <th>STRAQ_40<\/th>\n      <th>STRAQ_41<\/th>\n      <th>STRAQ_42<\/th>\n      <th>STRAQ_43<\/th>\n      <th>STRAQ_44<\/th>\n      <th>STRAQ_45<\/th>\n      <th>STRAQ_46<\/th>\n      <th>STRAQ_47<\/th>\n      <th>STRAQ_48<\/th>\n      <th>STRAQ_49<\/th>\n      <th>STRAQ_50<\/th>\n      <th>STRAQ_51<\/th>\n      <th>STRAQ_52<\/th>\n      <th>STRAQ_53<\/th>\n      <th>STRAQ_54<\/th>\n      <th>STRAQ_55<\/th>\n      <th>STRAQ_56<\/th>\n      <th>STRAQ_57<\/th>\n      <th>stress<\/th>\n      <th>stress1<\/th>\n      <th>stress2<\/th>\n      <th>stress3<\/th>\n      <th>stress4<\/th>\n      <th>stress5<\/th>\n      <th>stress6<\/th>\n      <th>stress7<\/th>\n      <th>stress8<\/th>\n      <th>stress9<\/th>\n      <th>stress10<\/th>\n      <th>stress11<\/th>\n      <th>stress12<\/th>\n      <th>stress13<\/th>\n      <th>stress14<\/th>\n      <th>Temperature_t1<\/th>\n      <th>Temperature_t2<\/th>\n      <th>thermotype<\/th>\n      <th>avgtemp<\/th>\n      <th>filter_.<\/th>\n      <th>mintemp<\/th>\n      <th>language<\/th>\n      <th>langfamily<\/th>\n      <th>Zanxiety<\/th>\n      <th>Zavoidance<\/th>\n      <th>Site<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
class: center, middle
&lt;span style="font-size: 60px;"&gt;9.2 PROCESS in R&lt;/span&gt; &lt;br&gt;
---
# &lt;h1 lang="zh-CN"&gt;想~~编~~一个模型&lt;/h1&gt;
&lt;div style="display:flex; align-items:center;"&gt;
  &lt;img src="fig/model7_hayse.png" style="width:45%; height: 45%;margin-right: 90px;"&gt;
  &lt;font size=20&gt; Model 7 &lt;/font&gt; 
&lt;/div&gt;
---
# &lt;h1 lang="zh-CN"&gt;想~~编~~一个模型&lt;/h1&gt;
&lt;div style="display:flex; align-items:center;"&gt;
  &lt;img src="fig/model7.png" style="width:100%; height: 100%;"&gt; &lt;br&gt;
&lt;/div&gt;
---
# &lt;h1 lang="zh-CN"&gt;清洗数据&lt;/h1&gt;
# &lt;h2 lang="zh-CN"&gt;对模型涉及变量的题目求均值&lt;/h2&gt;

```r
df.pg.mean &lt;- df.pg.raw %&gt;%
  dplyr::mutate(ALEX_mean = rowMeans(select(., starts_with("ALEX"))),
                ECR_mean = rowMeans(select(., starts_with("ECR"))),
                HOME_mean = rowMeans(select(., starts_with("HOME"))),
                KAMF_mean = rowMeans(select(., starts_with("KAMF")))
                ) %&gt;%
  dplyr::select(age, language, avgtemp, 
                ALEX_mean, ECR_mean, HOME_mean, KAMF_mean)
```
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-23f8602b2aba3c123741" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-23f8602b2aba3c123741">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6","7","8","9","10"],[1975,1995,1995,1988,1991,1995,1996,1973,1996,1996],[5,5,5,5,5,5,5,5,5,5],[35.4,35.9,35.1,36.95,35.7,35.55,36.15,36.55,35.5,36.1],[2.0625,2.1875,1.75,3.1875,2.3125,2.3125,2.375,3.1875,2.1875,2.75],[3.5,3.52777777777778,1.52777777777778,4.33333333333333,3.52777777777778,2.88888888888889,4.5,3.13888888888889,3.77777777777778,4.83333333333333],[3.11111111111111,4.88888888888889,1.33333333333333,3.88888888888889,4.66666666666667,3.33333333333333,3.11111111111111,3.55555555555556,3.33333333333333,3.22222222222222],[3.42857142857143,2.57142857142857,3.57142857142857,2.71428571428571,1.71428571428571,3,2,2.57142857142857,2.28571428571429,2.85714285714286]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>language<\/th>\n      <th>avgtemp<\/th>\n      <th>ALEX_mean<\/th>\n      <th>ECR_mean<\/th>\n      <th>HOME_mean<\/th>\n      <th>KAMF_mean<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="en"&gt;bruceR::PROCESS&lt;/h1&gt;
## &lt;h2 lang="en"&gt;CODE&lt;/h2&gt;

```r
result.PROCESS &lt;- capture.output({
# capture.output 可以将这段代码的结果存储进一个变量中
  bruceR::PROCESS(df.pg.mean,
                  x = "ALEX_mean", #自变量
                  y = "HOME_mean", # 因变量
                  meds = c("ECR_mean"), # 中介变量 
                  mods = c("KAMF_mean"), # 调节变量
                  covs = c("age", "language", "avgtemp"), # 控制变量（协变量）
                  #clusters = c(), #类似调节变量 分组变量
                  #hlm.re.m = "",hlm.re.y = "",hlm.type = c("1-1-1", "2-1-1", "2-2-1"),
                  #med.type = c("parallel", "serial"), # 中介变量之间是并列还是连续
                  #mod.type = c("2-way", "3-way"), # 两项交互还是三项交互
                  mod.path = c("x-m"), # 调节哪条路径
                  cov.path = c("both"), # 控制变量进入几个方程，both意味着中介和因变量都会考虑控制变量
                  #mod1.val = NULL,mod2.val = NULL, # 调节变量高低水平对应的值
                  ci = c("boot"), # 置信区间使用bootstrap 或其他抽样方法
                  nsim = 100, # 抽样的次数
                  #seed = NULL, # 设置seed可以让每次的抽样结果都一样
                  center = FALSE, # 是否对自变量和调节变量中心化。非中心化在解释时更方便
                  std = FALSE, # 是否在计算钱对所有变量进行标准化
                  digits = 3, # 保留的小数位数
                  #nsmall = digits,file = NULL
                  ) 
})
writeLines(result.PROCESS, "../OUTPUT/PROCESS.md") # .md最整齐
```

---
# &lt;h1 lang="en"&gt;bruceR::PROCESS&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/PROCESS_1.png)

---
# &lt;h1 lang="en"&gt;bruceR::PROCESS&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/PROCESS_2.png)

---
# &lt;h1 lang="en"&gt;bruceR::PROCESS&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/PROCESS_3.png)

---
# &lt;h1 lang="en"&gt;bruceR::PROCESS&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/PROCESS_4.png)

---
class: center, middle
&lt;span style="font-size: 60px;"&gt;9.2 SEM in R&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 40px;"&gt;using lavaan&lt;/span&gt; &lt;br&gt;

---
# &lt;h1 lang="zh-CN"&gt;结构方程模型的教科书&lt;/h1&gt;
&lt;br&gt;
&lt;center&gt;
&lt;h2 lang="en"&gt;引用量140k的经典：Hair (2009)&lt;/h2&gt;
&lt;/center&gt;
&lt;br&gt;

&lt;div style="display:flex; justify-content:center; align-items:center;"&gt;
  &lt;img src="https://m.media-amazon.com/images/P/B091YLY4LS.01._SCLZZZZZZZ_SX500_.jpg" style="width:30%; height: 30%; "&gt;
&lt;/div&gt;
&lt;br&gt;
&lt;center&gt;
&lt;h4 lang="zh-CN"&gt;之后的分析流程均参考自这本书&lt;/h4&gt;
&lt;/center&gt;
&lt;br&gt;
_&lt;h5 lang="en"&gt;- Hair, J. F. (2009). Multivariate data analysis. &lt;/h5&gt;_

---
# &lt;h1 lang="zh-CN"&gt;清洗数据&lt;/h1&gt;
# &lt;h2 lang="zh-CN"&gt;选择模型内的变量&lt;/h2&gt;

```r
df.pg.items &lt;- df.pg.raw %&gt;%
  dplyr::select(., age, language, avgtemp, 
                starts_with("ALEX"),
                starts_with("ECR"),
                starts_with("HOME"),
                starts_with("KAMF")
                ) 
```
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-923d3fca9d6304f5d1b3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-923d3fca9d6304f5d1b3">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6","7","8","9","10"],[1975,1995,1995,1988,1991,1995,1996,1973,1996,1996],[5,5,5,5,5,5,5,5,5,5],[35.4,35.9,35.1,36.95,35.7,35.55,36.15,36.55,35.5,36.1],[1,2,4,2,2,2,1,3,2,3],[1,2,1,3,1,3,1,3,3,3],[1,2,1,4,1,1,1,2,1,1],[2,2,2,5,5,3,1,3,3,2],[2,2,4,3,2,2,4,4,2,4],[1,2,1,4,2,1,1,4,2,1],[2,2,4,2,3,1,2,4,2,2],[2,2,1,4,4,2,1,4,2,4],[4,4,1,4,1,1,4,4,2,4],[1,2,2,3,1,2,2,5,2,1],[1,2,1,2,2,1,1,3,1,4],[2,2,1,2,1,2,2,2,2,1],[4,2,2,4,2,3,4,2,2,2],[3,2,1,2,4,4,3,3,4,3],[4,3,1,4,4,5,5,4,3,5],[2,2,1,3,2,4,5,1,2,4],[5,6,1,3,1,1,2,3,4,5],[5,4,1,6,1,1,1,2,4,6],[3,2,1,6,1,1,4,3,4,6],[5,5,1,5,1,2,1,2,4,5],[5,5,1,4,1,2,4,3,4,4],[3,2,1,4,5,1,1,3,1,3],[1,3,1,3,2,1,2,3,4,5],[6,5,1,3,1,2,7,3,4,7],[5,2,1,4,7,6,1,3,4,3],[2,3,1,4,1,2,4,1,4,3],[6,7,1,6,6,2,2,5,2,6],[3,4,1,5,1,2,1,2,4,4],[3,3,1,6,2,4,2,5,4,4],[2,3,7,5,1,1,1,4,1,2],[3,4,1,5,2,2,1,5,4,1],[3,5,3,5,1,1,2,3,4,4],[6,5,1,6,2,3,6,3,4,7],[1,5,1,5,2,2,4,2,4,4],[2,3,2,5,1,5,7,3,4,5],[2,4,2,5,7,5,1,2,4,7],[5,3,2,5,2,4,6,4,4,5],[3,2,2,4,5,4,7,3,4,5],[3,2,2,3,2,3,7,3,4,6],[2,3,1,4,4,4,7,3,4,5],[5,3,1,6,2,3,7,4,4,6],[5,4,1,3,6,3,7,4,4,7],[3,5,1,3,7,1,7,4,4,7],[2,3,1,4,6,3,6,3,4,4],[4,2,2,5,6,6,6,3,4,4],[2,2,2,3,6,5,7,2,4,5],[3,4,1,4,7,4,7,2,4,3],[3,2,2,5,2,3,7,3,4,6],[4,3,3,3,7,4,6,3,4,5],[5,3,1,2,6,5,7,4,4,6],[4,3,1,3,6,3,7,6,4,5],[2,3,2,4,7,3,7,2,4,4],[4,5,1,5,5,4,5,3,3,4],[3,5,1,4,5,4,2,3,3,5],[4,5,4,5,5,4,4,2,4,3],[3,5,1,5,5,4,5,4,5,3],[3,5,1,4,4,4,2,3,4,4],[2,4,1,2,5,2,1,4,3,2],[4,5,1,2,4,2,5,5,2,2],[3,5,1,4,4,3,1,4,3,3],[2,5,1,4,5,3,3,4,3,3],[4,1,5,5,1,3,2,3,3,4],[4,2,6,4,1,3,2,3,3,5],[5,6,5,3,3,3,2,2,2,1],[4,2,4,1,2,2,2,2,1,3],[4,3,3,2,2,2,2,2,3,2],[1,2,1,2,2,4,2,3,3,3],[2,2,1,2,1,4,2,3,1,2]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>language<\/th>\n      <th>avgtemp<\/th>\n      <th>ALEX1<\/th>\n      <th>ALEX2<\/th>\n      <th>ALEX3<\/th>\n      <th>ALEX4<\/th>\n      <th>ALEX5<\/th>\n      <th>ALEX6<\/th>\n      <th>ALEX7<\/th>\n      <th>ALEX8<\/th>\n      <th>ALEX9<\/th>\n      <th>ALEX10<\/th>\n      <th>ALEX11<\/th>\n      <th>ALEX12<\/th>\n      <th>ALEX13<\/th>\n      <th>ALEX14<\/th>\n      <th>ALEX15<\/th>\n      <th>ALEX16<\/th>\n      <th>ECR1<\/th>\n      <th>ECR2<\/th>\n      <th>ECR3<\/th>\n      <th>ECR4<\/th>\n      <th>ECR5<\/th>\n      <th>ECR6<\/th>\n      <th>ECR7<\/th>\n      <th>ECR8<\/th>\n      <th>ECR9<\/th>\n      <th>ECR10<\/th>\n      <th>ECR11<\/th>\n      <th>ECR12<\/th>\n      <th>ECR13<\/th>\n      <th>ECR14<\/th>\n      <th>ECR15<\/th>\n      <th>ECR16<\/th>\n      <th>ECR17<\/th>\n      <th>ECR18<\/th>\n      <th>ECR19<\/th>\n      <th>ECR20<\/th>\n      <th>ECR21<\/th>\n      <th>ECR22<\/th>\n      <th>ECR23<\/th>\n      <th>ECR24<\/th>\n      <th>ECR25<\/th>\n      <th>ECR26<\/th>\n      <th>ECR27<\/th>\n      <th>ECR28<\/th>\n      <th>ECR29<\/th>\n      <th>ECR30<\/th>\n      <th>ECR31<\/th>\n      <th>ECR32<\/th>\n      <th>ECR33<\/th>\n      <th>ECR34<\/th>\n      <th>ECR35<\/th>\n      <th>ECR36<\/th>\n      <th>HOME1<\/th>\n      <th>HOME2<\/th>\n      <th>HOME3<\/th>\n      <th>HOME4<\/th>\n      <th>HOME5<\/th>\n      <th>HOME6<\/th>\n      <th>HOME7<\/th>\n      <th>HOME8<\/th>\n      <th>HOME9<\/th>\n      <th>KAMF1<\/th>\n      <th>KAMF2<\/th>\n      <th>KAMF3<\/th>\n      <th>KAMF4<\/th>\n      <th>KAMF5<\/th>\n      <th>KAMF6<\/th>\n      <th>KAMF7<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="zh-CN"&gt;查找量表题目与维度的对应关系&lt;/h1&gt;

ALEX：16题(TAS-20)&lt;br&gt;    DIF1 3,5,6,7,10,11; DDF 2,4,8,9; EOT 12,13,14,15,16 &lt;br&gt;
_&lt;h5 lang="en"&gt;- Taylor, G. J., Bagby, R. M., &amp; Parker, J. D. (2003). The 20-Item Toronto Alexithymia Scale: IV. Reliability and factorial validity in different languages and cultures. Journal of psychosomatic research, 55(3), 277-283. &lt;/h5&gt;_

&lt;br&gt;

ECR：36题   1-18为焦虑，19-36为回避 &lt;br&gt;

_&lt;h5 lang="en"&gt;- Fraley, R. C., Waller, N. G., &amp; Brennan, K. A. (2000). An item response theory analysis of self-report measures of adult attachment. Journal of personality and social psychology, 78(2), 350. &lt;/h5&gt;_

&lt;br&gt;

HOME：9题 &lt;br&gt;
_&lt;h5 lang="zh-CN"&gt;来源未知&lt;/h5&gt;_

&lt;br&gt;

KAMF：7题 &lt;br&gt;
_&lt;h5 lang="zh-CN"&gt;来源未知&lt;/h5&gt;_

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;CODE&lt;/h2&gt;

```r
result.CFA_ALEX &lt;- capture.output({
  CFA_ALEX&lt;- 'DIF =~ ALEX1 + ALEX3 + ALEX5 + ALEX6 + ALEX7 + ALEX10 + ALEX11
              DDF =~ ALEX2 + ALEX4 + ALEX8 + ALEX9
              EOF =~ ALEX12 + ALEX13 + ALEX14 + ALEX15 + ALEX16
              ALEX =~ DIF + DDF + EOF' %&gt;%
  lavaan::cfa(.,data=df.pg.items,estimator="ML") 
  lavaan::summary(CFA_ALEX,fit.measures=TRUE,standardized=TRUE)
})
```

```
## Warning in lav_object_post_check(object): lavaan WARNING: some estimated lv
## variances are negative
```

```r
writeLines(result.CFA_ALEX, "../OUTPUT/CFA_ALEX.md")
```

_&lt;h3 lang="en"&gt;- Heywood Case&lt;/h3&gt;_

_&lt;h4 lang="zh-CN"&gt;- 报错说有方差为负&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 大概率是因为有两个维度（或题目）之间存在共线性&lt;/h4&gt;_

_&lt;h5 lang="en"&gt;- Van Driel, O. P. (1978). On various causes of improper solutions in maximum likelihood factor analysis. Psychometrika, 43, 225-243.&lt;/h5&gt;_

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;PLOT&lt;/h2&gt;

```r
lavaanPlot(model = CFA_ALEX, edge_options = list(color = "grey"))
```
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
![](fig/CFA_PLOT.png)
&lt;br&gt;
&lt;br&gt;
_&lt;h4 lang="zh-CN"&gt;- lavaan的画图并不是很好看，建议还是去AMOS里画图&lt;/h4&gt;_

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/CFA_ALEX_1.png)

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/CFA_ALEX_2.png)
_&lt;h4 lang="zh-CN"&gt;- 模型拟合度指标CFI, TLI, RMSEA, SRMR 问题都不大&lt;/h4&gt;_

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/CFA_ALEX_3.png)
_&lt;h4 lang="zh-CN"&gt;- 问题出在'DDF &lt;- ALEX '的载荷超过了1。说明DDF和某个维度之间存在共线性&lt;/h4&gt;_

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/CFA_ALEX_4.png)
_&lt;h4 lang="zh-CN"&gt;- DDF和某个维度之间存在共线性，所以DDF的方差为负&lt;/h4&gt;_

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;

```r
result.CFA_ALEX &lt;- capture.output({
  CFA_ALEX&lt;- 'DIF =~ ALEX1 + ALEX3 + ALEX5 + ALEX6 + ALEX7 + ALEX10 + ALEX11
              DDF =~ ALEX2 + ALEX4 + ALEX8 + ALEX9
              EOF =~ ALEX12 + ALEX13 + ALEX14 + ALEX15 + ALEX16' %&gt;%
  lavaan::cfa(.,data=df.pg.items,estimator="ML") 
  lavaan::summary(CFA_ALEX,fit.measures=TRUE,standardized=TRUE)
})
writeLines(result.CFA_ALEX, "../OUTPUT/CFA_ALEX.md")
```
_&lt;h4 lang="zh-CN"&gt;- 想弄明白DDF和谁有共线性，我们可以先不做二阶模型，把ALEX的三个维度当作三个一阶变量看待。&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 找到哪两个维度之间有高相关，然后将它们合并为一个维度&lt;/h4&gt;_
![](fig/CFA_ALEX_5.png)
_&lt;h4 lang="zh-CN"&gt;- 看来是DIF和DDF之间的相关过高了（存在共线性）&lt;/h4&gt;_

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;

```r
result.CFA_ALEX &lt;- capture.output({
  CFA_ALEX&lt;- 'DIDF =~ ALEX1 + ALEX3 + ALEX5 + ALEX6 + ALEX7 + ALEX10 + ALEX11 + ALEX2 + ALEX4 + ALEX8 + ALEX9
              EOF =~ ALEX12 + ALEX13 + ALEX14 + ALEX15 + ALEX16' %&gt;%
  lavaan::cfa(.,data=df.pg.items,estimator="ML") 
  lavaan::summary(CFA_ALEX,fit.measures=TRUE,standardized=TRUE)
})
writeLines(result.CFA_ALEX, "../OUTPUT/CFA_ALEX.md")
```
_&lt;h4 lang="zh-CN"&gt;- 按照原文(IJzerman et al., 2018)所说，将DIF和DDF合并为DIDF&lt;/h4&gt;_

![](fig/CFA_ALEX_6.png)

_&lt;h4 lang="zh-CN"&gt;- 两个维度无法做二阶变量（不足识别，自由度不够）&lt;/h4&gt;_
---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;CODE&lt;/h2&gt;

```r
result.CFA_ECR &lt;- capture.output({
  CFA_ECR&lt;- 'ANX =~ ECR1 + ECR2 + ECR3 + ECR4 + ECR5 + ECR6 + ECR7 + ECR8 + ECR9 + ECR10 + ECR11 + ECR12 + ECR13 + ECR14 + ECR15 + ECR16 + ECR17 + ECR18
             AVO =~ ECR19 + ECR20 + ECR21 + ECR22 + ECR23 + ECR24 + ECR25 + ECR26 + ECR27 + ECR28 + ECR29 + ECR30 + ECR31 + ECR32 + ECR33 + ECR34 + ECR35 + ECR36' %&gt;%
  lavaan::cfa(.,data=df.pg.items,estimator="ML") 
  lavaan::summary(CFA_ECR,fit.measures=TRUE,standardized=TRUE)
})
writeLines(result.CFA_ECR, "../OUTPUT/CFA_ECR.md")
```

```r
result.CFA_HOME &lt;- capture.output({
CFA_HOME&lt;- 'HOME =~ HOME1 + HOME2 + HOME3 + HOME4 + HOME5 + HOME6 + HOME7 + HOME8 + HOME9' %&gt;%
  lavaan::cfa(.,data=df.pg.items,estimator="ML") 
  lavaan::summary(CFA_HOME,fit.measures=TRUE,standardized=TRUE)
})
writeLines(result.CFA_HOME, "../OUTPUT/CFA_HOME.md")
```

```r
result.CFA_KAMF &lt;- capture.output({
CFA_KAMF&lt;- 'KAMF =~ KAMF1 + KAMF2 + KAMF3 + KAMF4 + KAMF5 + KAMF6 + KAMF7' %&gt;%
  lavaan::cfa(.,data=df.pg.items,estimator="ML") 
  lavaan::summary(CFA_KAMF,fit.measures=TRUE,standardized=TRUE)
})
writeLines(result.CFA_KAMF, "../OUTPUT/CFA_KAMF.md")
```

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;CODE&lt;/h2&gt;

```r
result.CFA &lt;- capture.output({
CFA&lt;- 'DIDF =~ ALEX1 + ALEX3 + ALEX5 + ALEX6 + ALEX7 + ALEX10 + ALEX11 + ALEX2 + ALEX4 + ALEX8 + ALEX9
       EOF =~ ALEX12 + ALEX13 + ALEX14 + ALEX15 + ALEX16
            
       ANX =~ ECR1 + ECR2 + ECR3 + ECR4 + ECR5 + ECR6 + ECR7 + ECR8 + ECR9 + ECR10 + ECR11 + ECR12 + ECR13 + ECR14 + ECR15 + ECR16 + ECR17 + ECR18
       AVO =~ ECR19 + ECR20 + ECR21 + ECR22 + ECR23 + ECR24 + ECR25 + ECR26 + ECR27 + ECR28 + ECR29 + ECR30 + ECR31 + ECR32 + ECR33 + ECR34 + ECR35 + ECR36
            
       HOME =~ HOME1 + HOME2 + HOME3 + HOME4 + HOME5 + HOME6 + HOME7 + HOME8 + HOME9
            
       KAMF =~ KAMF1 + KAMF2 + KAMF3 + KAMF4 + KAMF5 + KAMF6 + KAMF7' %&gt;%
       # ALEX =~ DIDF + EOF
       # ECR =~ ANX + AVO
       # 为了后面做收敛和区别效度方便些，这里采用一阶模型
  lavaan::cfa(.,data=df.pg.items,estimator="ML") 
  lavaan::summary(CFA,fit.measures=TRUE,standardized=TRUE)
})
writeLines(result.CFA, "../OUTPUT/CFA.md")
```
_&lt;h4 lang="zh-CN"&gt;- 在对每个变量都进行了CFA检验后，需要将所有变量放在一起做CFA。&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 此时自由度足够，哪怕是两维度的二阶变量，也可以定义为二阶变量&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 代码部分是为了后面方便做收敛与区别效度，没有做二阶&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 往后两张PPT 图片是以二阶模型得到的&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 结果过长，之后仅展现几个重点部分&lt;/h4&gt;_

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/CFA_0.png)
_&lt;h4 lang="zh-CN"&gt;- 模型拟合度比较糟糕&lt;/h4&gt;_

---
# &lt;h1 lang="zh-CN"&gt;验证性因素分析&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/CFA_1.png)
![](fig/CFA_2.png)
_&lt;h4 lang="zh-CN"&gt;- 两个二阶变量的二阶载荷可以接受&lt;/h4&gt;_
&lt;br&gt;
![](fig/CFA_3.png)
_&lt;h4 lang="zh-CN"&gt;- ALEX和ECR高度相关，如果是正式构建模型，建议只使用其中一个&lt;/h4&gt;_

---
# &lt;h1 lang="zh-CN"&gt;结构方程模型&lt;/h1&gt;
## &lt;h2 lang="en"&gt;CODE&lt;/h2&gt;

```r
result.SEM &lt;- capture.output({
SEM&lt;- 'DIDF =~ ALEX1 + ALEX3 + ALEX5 + ALEX6 + ALEX7 + ALEX10 + ALEX11 + ALEX2 + ALEX4 + ALEX8 + ALEX9
       EOF =~ ALEX12 + ALEX13 + ALEX14 + ALEX15 + ALEX16
       ALEX =~ DIDF + EOF
            
       ANX =~ ECR1 + ECR2 + ECR3 + ECR4 + ECR5 + ECR6 + ECR7 + ECR8 + ECR9 + ECR10 + ECR11 + ECR12 + ECR13 + ECR14 + ECR15 + ECR16 + ECR17 + ECR18
       AVO =~ ECR19 + ECR20 + ECR21 + ECR22 + ECR23 + ECR24 + ECR25 + ECR26 + ECR27 + ECR28 + ECR29 + ECR30 + ECR31 + ECR32 + ECR33 + ECR34 + ECR35 + ECR36
       ECR =~ ANX + AVO
            
       HOME =~ HOME1 + HOME2 + HOME3 + HOME4 + HOME5 + HOME6 + HOME7 + HOME8 + HOME9

       ECR ~ a*ALEX + age + language + avgtemp
       HOME ~ b*ECR + age + language + avgtemp

       ind_eff:=a*b ' %&gt;%
  lavaan::sem(.,data=df.pg.items,estimator="ML") 
  lavaan::summary(SEM,fit.measures=TRUE, standardized=TRUE, ci=TRUE)
})
writeLines(result.SEM, "../OUTPUT/SEM.md")
```

---
# &lt;h1 lang="zh-CN"&gt;结构方程模型&lt;/h1&gt;
## &lt;h2 lang="en"&gt;OUTPUT&lt;/h2&gt;
![](fig/SEM_1.png)
![](fig/SEM_2.png)
_&lt;h4 lang="zh-CN"&gt;- 这里的模型是ALEX -&gt; ECR -&gt; HOME简单的模型4&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 间接效应a*b是显著小于0的&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 潜变量的调节在lavaan中还只能以原始的手动交乘完成，有兴趣可以自己去探索&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 如果你的模型中一定用latent moderator，你可以使用Mplus，或者回到PROCESS&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;- 你完全可以把Mplus当作一个R包来使用：install.packages("MplusAutomation")&lt;/h4&gt;_
---
class: center, middle
&lt;span style="font-size: 60px;"&gt;9.3 Extra&lt;/span&gt; &lt;br&gt;
&lt;span style="font-size: 40px;"&gt;Convergent Validity and Discriminant Validity&lt;/span&gt; &lt;br&gt;

---
# &lt;h1 lang="zh-CN"&gt;收敛效度与区别效度&lt;/h1&gt;
## &lt;h2 lang="en"&gt;semTools&lt;/h2&gt;

```r
library(semTools)
```

```r
semTools::reliability(CFA)
```

```
##             DIDF       EOF       ANX       AVO      HOME      KAMF
## alpha  0.8802227 0.5001822 0.9199566 0.9167159 0.9029945 0.8660076
## omega  0.8826733 0.5034210 0.9227885 0.9161363 0.9017771 0.8706658
## omega2 0.8826733 0.5034210 0.9227885 0.9161363 0.9017771 0.8706658
## omega3 0.8832142 0.4951997 0.9219709 0.9077237 0.8925474 0.8707121
## avevar 0.4124118 0.1856855 0.4118027 0.3808808 0.5073557 0.4981098
```

```r
# 此处的alpha值与组成信度CR很接近
# avevar就是AVE的值

# 但是如果想得到一个比较完整的收敛效度与区别效度的表格，最好是是使用excel来完成
# R可以做，但是很麻烦
```

---
# &lt;h1 lang="zh-CN"&gt;收敛效度与区别效度&lt;/h1&gt;
## &lt;h2 lang="zh-CN"&gt;结果矩阵&lt;/h2&gt;

```r
matrix.CFA &lt;- lavaan::lavInspect(CFA,"standardized") 
CFA.loading &lt;- as.data.frame(matrix.CFA$lambda) %&gt;%
  dplyr::select(DIDF, EOF, ANX, AVO, HOME, KAMF) %&gt;%
  dplyr::mutate_at(vars(DIDF, EOF, ANX, AVO, HOME, KAMF), round, 3)
CFA.loading[CFA.loading == 0] &lt;- NA

CFA.correlation &lt;- as.data.frame(matrix.CFA$psi) %&gt;%
  dplyr::mutate_at(vars(DIDF, EOF, ANX, AVO, HOME, KAMF), round, 3) %&gt;%
  .[c("DIDF","EOF","ANX","AVO","HOME","KAMF"), c("DIDF","EOF","ANX","AVO","HOME","KAMF")]
# 如果是二阶模型，这里将看不到DIDF, EOF, ANX, AVO，只有ALEX和ECR

write.csv(CFA.loading, "../OUTPUT/CFA.loading.csv")
write.csv(CFA.correlation, "../OUTPUT/CFA.correlation.csv")
```
_&lt;h4 lang="zh-CN"&gt;题目    &lt;-    潜变量 = 'matrix.CFA$lambda'&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;题目    &lt;-&gt;   题目 = 'matrix.CFA$theta'&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;潜变量  &lt;-&gt;   潜变量 = 'matrix.CFA$psi'&lt;/h4&gt;_
_&lt;h4 lang="zh-CN"&gt;潜变量  &lt;-    潜变量 = 'matrix.CFA$psi'   在CFA中表示： 一阶潜变量  &lt;-    二阶潜变量&lt;/h4&gt;_
&lt;br&gt;
_&lt;h4 lang="zh-CN"&gt;潜变量  &lt;-    潜变量 = 'matrix.SEM$beta'  在SEM中表示： 潜变量   &lt;-   潜变量&lt;/h4&gt;_
---
# &lt;h1 lang="zh-CN"&gt;结果矩阵&lt;/h1&gt;
## &lt;h2 lang="en"&gt;Factor Loading (lambda λ) &lt;/h2&gt;
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-2636ca5d1e229ef1104d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2636ca5d1e229ef1104d">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["ALEX1","ALEX3","ALEX5","ALEX6","ALEX7","ALEX10","ALEX11","ALEX2","ALEX4","ALEX8","ALEX9","ALEX12","ALEX13","ALEX14","ALEX15","ALEX16","ECR1","ECR2","ECR3","ECR4","ECR5","ECR6","ECR7","ECR8","ECR9","ECR10","ECR11","ECR12","ECR13","ECR14","ECR15","ECR16","ECR17","ECR18","ECR19","ECR20","ECR21","ECR22","ECR23","ECR24","ECR25","ECR26","ECR27","ECR28","ECR29","ECR30","ECR31","ECR32","ECR33","ECR34","ECR35","ECR36","HOME1","HOME2","HOME3","HOME4","HOME5","HOME6","HOME7","HOME8","HOME9","KAMF1","KAMF2","KAMF3","KAMF4","KAMF5","KAMF6","KAMF7"],[0.759,0.444,0.67,0.632,0.702,0.729,0.595,0.715,0.596,0.676,0.458,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,0.151,0.35,0.51,0.477,0.538,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.709,0.828,0.829,0.794,0.584,0.637,0.691,0.741,0.546,0.639,0.212,0.674,0.612,0.548,0.636,0.509,0.569,0.53,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.57,0.721,0.445,0.734,0.652,0.633,0.56,0.757,0.587,0.714,0.66,0.691,0.691,0.6,0.423,0.477,0.647,0.619,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.758,0.794,0.712,0.759,0.772,0.709,0.538,0.745,0.692,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.605,0.744,0.693,0.701,0.802,0.674,0.658]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>DIDF<\/th>\n      <th>EOF<\/th>\n      <th>ANX<\/th>\n      <th>AVO<\/th>\n      <th>HOME<\/th>\n      <th>KAMF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="zh-CN"&gt;结果矩阵&lt;/h1&gt;
## &lt;h2 lang="en"&gt; Latent Variable Correlations (psi ψ)&lt;/h2&gt;
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-592e8cb100d14989bd90" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-592e8cb100d14989bd90">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["DIDF","EOF","ANX","AVO","HOME","KAMF"],[1,0.291,0.48,0.345,-0.135,0.039],[0.291,1,0.114,0.401,-0.097,-0.363],[0.48,0.114,1,0.433,-0.145,0.056],[0.345,0.401,0.433,1,-0.224,-0.141],[-0.135,-0.097,-0.145,-0.224,1,0.073],[0.039,-0.363,0.056,-0.141,0.073,1]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>DIDF<\/th>\n      <th>EOF<\/th>\n      <th>ANX<\/th>\n      <th>AVO<\/th>\n      <th>HOME<\/th>\n      <th>KAMF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="zh-CN"&gt;收敛效度&lt;/h1&gt;
## &lt;h2 lang="en"&gt;Average Variance Extracted&lt;/h2&gt; 

```r
AVE &lt;- CFA.loading %&gt;%
  # 分别对每个潜变量对应的题目的所有载荷求平方，又名SMC Squared Multiple Correlation
  dplyr::mutate(across(.cols = everything(), ~ .^2, .names = "{col}_SMC")) %&gt;% 
  # 求SMC的平均值 即AVE Average Variance Extracted
  dplyr::mutate(across(contains("_SMC"), ~ mean(., na.rm = TRUE),.names = "{col}_mean")) %&gt;% 
  # 会出现很多列结尾为mean的变量，即刚刚求的平均值（每一行的值都是重复的）
  tidyr::pivot_longer(cols = contains("_mean"), names_to = "var") %&gt;% 
  # 需要把这些宽数据转化为长数据
  tidyr::separate(var, into = c("name", "type"), sep = "_SMC_mean") %&gt;% 
  dplyr::select(Variable = name, AVE = value) %&gt;%
  dplyr::distinct() %&gt;% # 删掉重复的值
  # 给AVE开方，用于之后求区别效度
  dplyr::mutate(sqrt_AVE = sqrt(AVE)) %&gt;% 
  dplyr::mutate_at(vars(AVE, sqrt_AVE), round, 3)
```

---
# &lt;h1 lang="zh-CN"&gt;收敛效度&lt;/h1&gt;
## &lt;h2 lang="en"&gt;Average Variance Extracted&lt;/h2&gt; 
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-c0fdfa3f339418e0e179" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c0fdfa3f339418e0e179">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6"],["DIDF","EOF","ANX","AVO","HOME","KAMF"],[0.412,0.184,0.413,0.395,0.523,0.489],[0.642,0.43,0.642,0.628,0.723,0.699]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>AVE<\/th>\n      <th>sqrt_AVE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="zh-CN"&gt;收敛效度&lt;/h1&gt;
## &lt;h2 lang="en"&gt;Composite Reliability&lt;/h2&gt; 

```r
# 我这里的方法很笨，将CR的计算公式一步步分解，然后手动计算
CR &lt;- CFA.loading %&gt;%
  # 对所有载荷求平方，又名SMC Squared Multiple Correlation
  dplyr::mutate(across(.cols = everything(), ~ .^2, .names = "{col}_SMC")) %&gt;% 
  # 求1-SMC 用于之后计算CR Average Variance Extracted
  dplyr::mutate(across(contains("_SMC"), ~ 1 - ., .names = "{col}_res")) %&gt;% 
  # 把SMC_res改名为_res
  dplyr::rename_with(~sub("_SMC_res$", "_res", .), contains("_SMC_res")) %&gt;% 
  # 给loading列增加_LD的标签，方便后面计算
  dplyr::rename_at(vars(matches("^([^_]+)$")), ~paste0(., "_LD")) %&gt;% 
  # 对每一列求和
  colSums(.,na.rm = TRUE) %&gt;%
  data.frame(variable = names(.), total = .) %&gt;%
  tidyr::pivot_wider(., names_from = "variable", values_from = "total") %&gt;%
  dplyr::mutate(DIDF_CR = DIDF_LD*DIDF_LD / (DIDF_LD*DIDF_LD + DIDF_res),
                EOF_CR = EOF_LD*EOF_LD / (EOF_LD*EOF_LD + EOF_res),
                ANX_CR = ANX_LD*ANX_LD / (ANX_LD*ANX_LD + ANX_res),
                AVO_CR = AVO_LD*AVO_LD / (AVO_LD*AVO_LD + AVO_res),
                HOME_CR = HOME_LD*HOME_LD / (HOME_LD*HOME_LD + HOME_res),
                KAMF_CR = KAMF_LD*KAMF_LD / (KAMF_LD*DIDF_LD + KAMF_res)) %&gt;%
  dplyr::mutate_at(vars(DIDF_CR, EOF_CR, ANX_CR, AVO_CR, HOME_CR, KAMF_CR), round, 3) %&gt;%
  dplyr::select(DIDF_CR, EOF_CR, ANX_CR, AVO_CR, HOME_CR, KAMF_CR) %&gt;%
  tidyr::pivot_longer(DIDF_CR:KAMF_CR,names_to = "Variable", values_to = "CR")
```

---
# &lt;h1 lang="zh-CN"&gt;收敛效度&lt;/h1&gt;
## &lt;h2 lang="en"&gt;Composite Reliability&lt;/h2&gt; 
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b37cb358f5670ad45acf" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b37cb358f5670ad45acf">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["1","2","3","4","5","6"],["DIDF_CR","EOF_CR","ANX_CR","AVO_CR","HOME_CR","KAMF_CR"],[0.883,0.502,0.923,0.92,0.907,0.633]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>CR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="zh-CN"&gt;区别效度&lt;/h1&gt;
## &lt;h2 lang="en"&gt;Discriminant Validity&lt;/h2&gt;
_&lt;h4 lang="zh-CN"&gt;写一个循环，把得到的根号下AVE填写到潜变量相关矩阵的对角线上&lt;/h4&gt;_


```r
# 循环遍历AVE中的每个变量
for(var in AVE$Variable) {   
  # 找到匹配的行和列名称
  row_name &lt;- col_name &lt;- var   
  # 从AVE中获取sqrt_AVE的值
  sqrt_ave &lt;- AVE$sqrt_AVE[AVE$Variable == var]   
  # 将CFA.correlation中的单元格替换为sqrt_AVE的值
  CFA.correlation[row_name, col_name] &lt;- sqrt_ave  
}
rm(row_name,sqrt_ave,col_name,var)
# 我不会在R里定义局部变量，所以我习惯在循环结束后删除循环中用到的中间变量
```

---
# &lt;h1 lang="zh-CN"&gt;区别效度&lt;/h1&gt;
## &lt;h2 lang="en"&gt;Discriminant Validity&lt;/h2&gt;
_&lt;h4 lang="zh-CN"&gt;对角线为根号下AVE。如果该变量的根号下AVE大于该变量与其他变量的相关，则说明该变量与其他变量之间具有区别效度&lt;/h4&gt;_
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-17f20f1bce7c2968ac9e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-17f20f1bce7c2968ac9e">{"x":{"filter":"none","vertical":false,"fillContainer":true,"data":[["DIDF","EOF","ANX","AVO","HOME","KAMF"],[0.642,0.291,0.48,0.345,-0.135,0.039],[0.291,0.43,0.114,0.401,-0.097,-0.363],[0.48,0.114,0.642,0.433,-0.145,0.056],[0.345,0.401,0.433,0.628,-0.224,-0.141],[-0.135,-0.097,-0.145,-0.224,0.723,0.073],[0.039,-0.363,0.056,-0.141,0.073,0.699]],"container":"<table class=\"display fill-container\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>DIDF<\/th>\n      <th>EOF<\/th>\n      <th>ANX<\/th>\n      <th>AVO<\/th>\n      <th>HOME<\/th>\n      <th>KAMF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
# &lt;h1 lang="zh-CN"&gt;偷偷告诉你&lt;/h1&gt;
&lt;br&gt;

&lt;font size = 25&gt;
有计算AVE和CR的Excel，&lt;br&gt;
只需要把标准化载荷粘贴进去 &lt;br&gt;
就做好收敛和区别效度表
&lt;/font&gt;
&lt;div style="display:flex; align-items:center; justify-content:center;"&gt;
  &lt;img src="http://5b0988e595225.cdn.sohucs.com/images/20190731/106c2df806734067b92ef5aee97a70cd.jpeg" style="width:30%; height: 30%; margin-right: 20px;"&gt;
&lt;/div&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
